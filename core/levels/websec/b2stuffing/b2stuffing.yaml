imports:
- path: ubuntu_vm.jinja
- path: container_vm.jinja


resources:
- name: b2-attack-instance
  type: ubuntu_vm.jinja
  properties:
    zone: us-west1-b
    open_external: true
    startup-script: |
      #!/bin/bash
      sudo apt update
      sudo apt install -y python-pip

- name: b2-container-vm-0
  type: container_vm.jinja
  properties:
    zone: us-west1-b
    open_external: true
    open_http: true
    container_manifest: |
      apiVersion: v1
      kind: Pod
      metadata:
        name: b2-0
      spec:
        containers:
          - name: b2-0
            image: docker.io/wwupdx/websec-b2:latest
            imagePullPolicy: Always
            env:
              - name: USERNAME
                value: {{user_r0}}
              - name: PASSWORD
                value: {{pass_r0}}
              - name: PORT
                value: 80

- name: b2-container-vm-1
  type: container_vm.jinja
  properties:
    zone: us-west1-b
    open_external: true
    open_http: true
    container_manifest: |
      apiVersion: v1
      kind: Pod
      metadata:
        name: b2-1
      spec:
        containers:
          - name: b2-1
            image: docker.io/wwupdx/websec-b2:latest
            imagePullPolicy: Always
            env:
              - name: USERNAME
                value: {{user_r1}}
              - name: PASSWORD
                value: {{pass_r1}}
              - name: PORT
                value: 80

- name: b2-container-vm-2
  type: container_vm.jinja
  properties:
    zone: us-west1-b
    open_external: true
    open_http: true
    container_manifest: |
      apiVersion: v1
      kind: Pod
      metadata:
        name: b2-2
      spec:
        containers:
          - name: b2-2
            image: docker.io/wwupdx/websec-b2:latest
            imagePullPolicy: Always
            env:
              - name: USERNAME
                value: {{user_r2}}
              - name: PASSWORD
                value: {{pass_r2}}
              - name: PORT
                value: 80

              


